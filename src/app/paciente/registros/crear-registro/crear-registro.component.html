  <form [formGroup]="form" class="panel__main" (ngSubmit)="createRegistro()">
  
    <section class="panel__inner--main">

      <header class="panel__header--row">
          <app-label
          size="lg"
          [label]="editableTitle"
          [prefix]="editableCategory"
          [icon]="editableIcon"
          [severity]="editableColor"
          direction="row"
        ></app-label>
        <app-badge type="success" label="Registro guardado" size="md"></app-badge>
      </header>

      <div class="form__input-wrapper--col">
        <label for="titulo">Titulo</label>
        <input type="text" formControlName="titulo" (keyup)="onTitleChange()">
      </div>

      @if (!qrResultString) {
      <div class="form__input-wrapper--col">
        <label for="descripcion"
          >Description (optional)</label>
          <textarea
            rows="5"
            type="text"
            id="descripcion"
            class=""
            placeholder="Your description goes here"
            formControlName="descripcion"
          ></textarea>
        </div>
      }

      @if (qrResultString) {
        <div class="form__input-wrapper--col">
          <label for="paciente">Registro de esta consulta</label>
          <textarea 
            id="paciente"
            formControlName="paciente">
            {{ qrResultString }}
          </textarea>
          <button (click)="clearResult()">&times;</button>
        </div>
        }

        <div class="form__input-wrapper--col">
          <label for="categoria">Categoría</label>
          <select id="categoria" formControlName="categoria" (change)="onCategoryChange()">
            <option value="" disabled selected>Select a category</option>
            @for (categoria of categorias; track categoria) {
              <option [value]="categoria">
                {{ categoria }}
              </option>
            }
          </select>
        </div>
    </section>
    <section class="panel__inner--aside">
        <app-label
            size="md"
            [label]="'registro.fecha'"
            [prefix]="'fecha'">
        </app-label>
        <app-label
            size="md"
            [label]="'registro.emisor'"
            [prefix]="'emisor'">
        </app-label>
        <app-switcher
            [on]="true"
            size="lg"
            onLabel="Validado"
            offLabel="No validado"
            colorOn="green"
            colorOff="red"
            labelPosition="right"
        ></app-switcher>
        <!-- Integración QR con portal-profesional -->
        <img class="panel__qr--aside" src="./assets/img/panel__qr--aside.png" alt="">
        <app-label
            [size]="'sm'"
            [prefix]="'Para escanear el código, accede a tu cuenta experienciaPaciente.org.'"
            [direction]="'row'"
            [severity]="'neutral'"
            [icon]="'info-circle'"
        >
        </app-label>
    </section>
       <!-- Desacoplar footer en componente -->
       <footer class="panel__footer">
        <app-button
        size="xs"
        [severity]="'danger'"
        [variant]="'link'"
        [icon]="'pencil'"
        [direction]="'row'"
        [label]="'Editar'"
        ></app-button>
        <app-button
        severity="success"
        type="submit"
        label="Guardar registro"
        size="xs"
      >
        @if (registroId) {
          Editar registro
        } @else {
          Crearr registro
        }
      </app-button>
    </footer>
  </form>
